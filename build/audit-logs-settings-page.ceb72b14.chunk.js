"use strict";(self.webpackChunkbe_trading=self.webpackChunkbe_trading||[]).push([[2812],{13882:(Z,E,t)=>{t.d(E,{Z:()=>e});function e(r,d){if(d.length<r)throw new TypeError(r+" argument"+(r>1?"s":"")+" required, but only "+d.length+" present")}},83946:(Z,E,t)=>{t.d(E,{Z:()=>e});function e(r){if(r===null||r===!0||r===!1)return NaN;var d=Number(r);return isNaN(d)?d:d<0?Math.ceil(d):Math.floor(d)}},12902:(Z,E,t)=>{t.d(E,{Z:()=>ce});var e=7,r=365.2425,d=Math.pow(10,8)*24*60*60*1e3,h=6e4,L=36e5,P=1e3,M=-d,A=60,I=3,S=12,f=4,o=3600,F=60,$=o*24,U=$*7,O=$*r,W=O/12,me=W*3,te=t(13882),ae=t(83946);function ce(n,a){var s;(0,te.Z)(1,arguments);var i=(0,ae.Z)((s=a?.additionalDigits)!==null&&s!==void 0?s:2);if(i!==2&&i!==1&&i!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(!(typeof n=="string"||Object.prototype.toString.call(n)==="[object String]"))return new Date(NaN);var u=ne(n),T;if(u.date){var V=ge(u.date,i);T=se(V.restDateString,V.year)}if(!T||isNaN(T.getTime()))return new Date(NaN);var N=T.getTime(),R=0,b;if(u.time&&(R=re(u.time),isNaN(R)))return new Date(NaN);if(u.timezone){if(b=ie(u.timezone),isNaN(b))return new Date(NaN)}else{var j=new Date(N+R),X=new Date(0);return X.setFullYear(j.getUTCFullYear(),j.getUTCMonth(),j.getUTCDate()),X.setHours(j.getUTCHours(),j.getUTCMinutes(),j.getUTCSeconds(),j.getUTCMilliseconds()),X}return new Date(N+R+b)}var Y={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},G=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Q=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,J=/^([+-])(\d{2})(?::?(\d{2}))?$/;function ne(n){var a={},s=n.split(Y.dateTimeDelimiter),i;if(s.length>2)return a;if(/:/.test(s[0])?i=s[0]:(a.date=s[0],i=s[1],Y.timeZoneDelimiter.test(a.date)&&(a.date=n.split(Y.timeZoneDelimiter)[0],i=n.substr(a.date.length,n.length))),i){var u=Y.timezone.exec(i);u?(a.time=i.replace(u[1],""),a.timezone=u[1]):a.time=i}return a}function ge(n,a){var s=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+a)+"})|(\\d{2}|[+-]\\d{"+(2+a)+"})$)"),i=n.match(s);if(!i)return{year:NaN,restDateString:""};var u=i[1]?parseInt(i[1]):null,T=i[2]?parseInt(i[2]):null;return{year:T===null?u:T*100,restDateString:n.slice((i[1]||i[2]).length)}}function se(n,a){if(a===null)return new Date(NaN);var s=n.match(G);if(!s)return new Date(NaN);var i=!!s[4],u=x(s[1]),T=x(s[2])-1,V=x(s[3]),N=x(s[4]),R=x(s[5])-1;if(i)return ue(a,N,R)?oe(a,N,R):new Date(NaN);var b=new Date(0);return!le(a,T,V)||!de(a,u)?new Date(NaN):(b.setUTCFullYear(a,T,Math.max(u,V)),b)}function x(n){return n?parseInt(n):1}function re(n){var a=n.match(Q);if(!a)return NaN;var s=z(a[1]),i=z(a[2]),u=z(a[3]);return _(s,i,u)?s*L+i*h+u*1e3:NaN}function z(n){return n&&parseFloat(n.replace(",","."))||0}function ie(n){if(n==="Z")return 0;var a=n.match(J);if(!a)return 0;var s=a[1]==="+"?-1:1,i=parseInt(a[2]),u=a[3]&&parseInt(a[3])||0;return w(i,u)?s*(i*L+u*h):NaN}function oe(n,a,s){var i=new Date(0);i.setUTCFullYear(n,0,4);var u=i.getUTCDay()||7,T=(a-1)*7+s+1-u;return i.setUTCDate(i.getUTCDate()+T),i}var k=[31,null,31,30,31,30,31,31,30,31,30,31];function q(n){return n%400===0||n%4===0&&n%100!==0}function le(n,a,s){return a>=0&&a<=11&&s>=1&&s<=(k[a]||(q(n)?29:28))}function de(n,a){return a>=1&&a<=(q(n)?366:365)}function ue(n,a,s){return a>=1&&a<=53&&s>=0&&s<=6}function _(n,a,s){return n===24?a===0&&s===0:s>=0&&s<60&&a>=0&&a<60&&n>=0&&n<25}function w(n,a){return a>=0&&a<=59}},50935:(Z,E,t)=>{t.d(E,{R:()=>h});var e=t(88767),r=t(2911),d=t(36232);function h(L={},P={}){const{id:M="",...A}=L,I=(0,d.stringify)(A,{encode:!1}),{get:S}=(0,r.kY)(),{data:f,isError:o,isLoading:F,refetch:$}=(0,e.useQuery)(["users",M,A],async()=>{const{data:{data:O}}=await S(`/admin/users/${M}${I?`?${I}`:""}`);return O},P);let U=[];return M&&f?U=[f]:Array.isArray(f?.results)&&(U=f.results),{users:U,pagination:f?.pagination??null,isLoading:F,isError:o,refetch:$}}},94699:(Z,E,t)=>{t.d(E,{Z:()=>S});var e=t(53547),r=t(45697),d=t.n(r),h=t(86896),L=t(41580),P=t(29728),M=t(89597),A=t(2911);const I=({displayedFilters:f})=>{const[o,F]=(0,e.useState)(!1),{formatMessage:$}=(0,h.Z)(),U=(0,e.useRef)(),O=()=>{F(W=>!W)};return e.createElement(e.Fragment,null,e.createElement(L.x,{paddingTop:1,paddingBottom:1},e.createElement(P.z,{variant:"tertiary",ref:U,startIcon:e.createElement(M.Z,null),onClick:O,size:"S"},$({id:"app.utils.filters",defaultMessage:"Filters"})),o&&e.createElement(A.J5,{displayedFilters:f,isVisible:o,onToggle:O,source:U})),e.createElement(A.W$,{filtersSchema:f}))};I.propTypes={displayedFilters:d().arrayOf(d().shape({name:d().string.isRequired,metadatas:d().shape({label:d().string}),fieldSchema:d().shape({type:d().string})})).isRequired};const S=I},35915:(Z,E,t)=>{t.r(E),t.d(E,{default:()=>he});var e=t(53547),r=t(2911),d=t(87751),h=t(86896),L=t(17034),P=t(49066),M=t(41580),A=t(185),I=t(53979),S=t(36989),f=t(45697),o=t.n(f),F=t(15234),$=t(79031),U=t(37909),O=t(75515),W=t(11047),me=t(12028),te=t(8934),ae=t(12902);const Y=()=>{const{formatDate:l}=(0,h.Z)();return D=>{const g=(0,ae.Z)(D),y=l(g,{dateStyle:"long"}),m=l(g,{timeStyle:"medium",hourCycle:"h24"});return`${y}, ${m}`}},G={"entry.create":"Create entry{model, select, undefined {} other { ({model})}}","entry.update":"Update entry{model, select, undefined {} other { ({model})}}","entry.delete":"Delete entry{model, select, undefined {} other { ({model})}}","entry.publish":"Publish entry{model, select, undefined {} other { ({model})}}","entry.unpublish":"Unpublish entry{model, select, undefined {} other { ({model})}}","media.create":"Create media","media.update":"Update media","media.delete":"Delete media","media-folder.create":"Create media folder","media-folder.update":"Update media folder","media-folder.delete":"Delete media folder","user.create":"Create user","user.update":"Update user","user.delete":"Delete user","admin.auth.success":"Admin login","admin.logout":"Admin logout","content-type.create":"Create content type","content-type.update":"Update content type","content-type.delete":"Delete content type","component.create":"Create component","component.update":"Update component","component.delete":"Delete component","role.create":"Create role","role.update":"Update role","role.delete":"Delete role","permission.create":"Create permission","permission.update":"Update permission","permission.delete":"Delete permission"},Q=l=>G[l]||l,J=({headers:l,rows:v,onOpenModal:D})=>{const{formatMessage:g}=(0,h.Z)(),y=Y(),m=({type:p,value:c,model:C})=>p==="date"?y(c):p==="action"?g({id:`Settings.permissions.auditLogs.${c}`,defaultMessage:Q(c)},{model:C}):c||"-";return e.createElement(F.p,null,v.map(p=>e.createElement($.Tr,{key:p.id,...(0,r.X7)({fn:()=>D(p.id)})},l.map(({key:c,name:C,cellFormatter:K})=>e.createElement(U.Td,{key:c},e.createElement(O.Z,{textColor:"neutral800"},m({type:c,value:K?K(p[C]):p[C],model:p.payload?.model})))),e.createElement(U.Td,{...r.UW},e.createElement(W.k,{justifyContent:"end"},e.createElement(me.h,{onClick:()=>D(p.id),"aria-label":g({id:"app.component.table.view",defaultMessage:"{target} details"},{target:`${p.action} action`}),noBorder:!0,icon:e.createElement(te.Z,null)}))))))};J.defaultProps={rows:[]},J.propTypes={headers:o().array.isRequired,rows:o().array,onOpenModal:o().func.isRequired};const ne=J,se=[{name:"action",key:"action",metadatas:{label:{id:"Settings.permissions.auditLogs.action",defaultMessage:"Action"},sortable:!0}},{name:"date",key:"date",metadatas:{label:{id:"Settings.permissions.auditLogs.date",defaultMessage:"Date"},sortable:!0}},{key:"user",name:"user",metadatas:{label:{id:"Settings.permissions.auditLogs.user",defaultMessage:"User"},sortable:!1},cellFormatter:l=>l?l.displayName:""}],x=({pagination:l})=>e.createElement(M.x,{paddingTop:4},e.createElement(W.k,{alignItems:"flex-end",justifyContent:"space-between"},e.createElement(r.v4,null),e.createElement(r.tU,{pagination:l})));x.defaultProps={pagination:{pageCount:0,pageSize:50,total:0}},x.propTypes={pagination:o().shape({page:o().number,pageCount:o().number,pageSize:o().number,total:o().number})};const re=x;var z=t(88767),ie=t(42866),oe=t(24969),k=t(2407),q=t(59946),le=t(77197),de=t(11276),ue=t(39990);const _=({actionLabel:l,actionName:v})=>e.createElement(W.k,{direction:"column",alignItems:"baseline",gap:1},e.createElement(O.Z,{textColor:"neutral600",variant:"sigma"},l),e.createElement(O.Z,{textColor:"neutral600"},v));_.propTypes={actionLabel:o().string.isRequired,actionName:o().string.isRequired};const w=_,n=({status:l,data:v,formattedDate:D})=>{const{formatMessage:g}=(0,h.Z)();if(l==="loading")return e.createElement(W.k,{padding:7,justifyContent:"center",alignItems:"center"},e.createElement(le.a,null,"Loading content..."));const{action:y,user:m,payload:p}=v;return e.createElement(e.Fragment,null,e.createElement(M.x,{marginBottom:3},e.createElement(O.Z,{variant:"delta",id:"title"},g({id:"Settings.permissions.auditLogs.details",defaultMessage:"Log Details"}))),e.createElement(de.r,{gap:4,gridCols:2,paddingTop:4,paddingBottom:4,paddingLeft:6,paddingRight:6,marginBottom:4,background:"neutral100",hasRadius:!0},e.createElement(w,{actionLabel:g({id:"Settings.permissions.auditLogs.action",defaultMessage:"Action"}),actionName:g({id:`Settings.permissions.auditLogs.${y}`,defaultMessage:Q(y)},{model:p?.model})}),e.createElement(w,{actionLabel:g({id:"Settings.permissions.auditLogs.date",defaultMessage:"Date"}),actionName:D}),e.createElement(w,{actionLabel:g({id:"Settings.permissions.auditLogs.user",defaultMessage:"User"}),actionName:m?.displayName||"-"}),e.createElement(w,{actionLabel:g({id:"Settings.permissions.auditLogs.userId",defaultMessage:"User ID"}),actionName:m?.id.toString()||"-"})),e.createElement(ue.V,{value:JSON.stringify(p,null,2),disabled:!0,label:g({id:"Settings.permissions.auditLogs.payload",defaultMessage:"Payload"})}))};n.defaultProps={data:{}},n.propTypes={status:o().oneOf(["idle","loading","error","success"]).isRequired,data:o().shape({action:o().string,date:o().string,payload:o().object,user:o().object}),formattedDate:o().string.isRequired};const a=n,s=({handleClose:l,logId:v})=>{const{get:D}=(0,r.kY)(),g=(0,r.lm)(),y=async K=>{const{data:H}=await D(`/admin/audit-logs/${K}`);if(!H)throw new Error("Audit log not found");return H},{data:m,status:p}=(0,z.useQuery)(["audit-log",v],()=>y(v),{onError(){g({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}}),l()}}),c=Y(),C=m?c(m.date):"";return e.createElement(ie.P,{onClose:l,labelledBy:"title"},e.createElement(oe.x,null,e.createElement(k.O,{label:C,id:"title"},e.createElement(k.$,null,C))),e.createElement(q.f,null,e.createElement(a,{status:p,data:m,formattedDate:C})))};s.propTypes={handleClose:o().func.isRequired,logId:o().string.isRequired};const i=s;var u=t(94699),T=t(29178),V=t(90608);const N=({value:l,options:v,onChange:D})=>{const{formatMessage:g}=(0,h.Z)(),y=g({id:"Settings.permissions.auditLogs.filter.aria-label",defaultMessage:"Search and select an option to filter"});return e.createElement(T.hQ,{"aria-label":y,value:l,onChange:D},v.map(({label:m,customValue:p})=>e.createElement(V.O,{key:p,value:p},m)))};N.defaultProps={value:null},N.propTypes={value:o().string,options:o().arrayOf(o().shape({label:o().string.isRequired,customValue:o().string.isRequired}).isRequired).isRequired,onChange:o().func.isRequired};const R=N,b=[{intlLabel:{id:"components.FilterOptions.FILTER_TYPES.$eq",defaultMessage:"is"},value:"$eq"},{intlLabel:{id:"components.FilterOptions.FILTER_TYPES.$ne",defaultMessage:"is not"},value:"$ne"}],X=({formatMessage:l,users:v,canReadUsers:D})=>{const g=Object.keys(G).map(m=>({label:l({id:`Settings.permissions.auditLogs.${m}`,defaultMessage:Q(m)},{model:void 0}),customValue:m})),y=[{name:"action",metadatas:{customOperators:b,label:l({id:"Settings.permissions.auditLogs.action",defaultMessage:"Action"}),options:g,customInput:R},fieldSchema:{type:"enumeration"}},{name:"date",metadatas:{label:l({id:"Settings.permissions.auditLogs.date",defaultMessage:"Date"})},fieldSchema:{type:"datetime"}}];if(D&&v){const m=c=>c.username?c.username:c.firstname&&c.lastname?l({id:"Settings.permissions.auditLogs.user.fullname",defaultMessage:"{firstname} {lastname}"},{firstname:c.firstname,lastname:c.lastname}):c.email,p=v.map(c=>({label:m(c),customValue:c.id.toString()}));return[...y,{name:"user",metadatas:{customOperators:b,label:l({id:"Settings.permissions.auditLogs.user",defaultMessage:"User"}),options:p,customInput:R},fieldSchema:{type:"relation",mainField:{name:"id"}}}]}return y};var pe=t(16550),fe=t(50935);const ve=({canReadAuditLogs:l,canReadUsers:v})=>{const{get:D}=(0,r.kY)(),{search:g}=(0,pe.TH)(),y=(0,r.lm)(),m={keepPreviousData:!0,retry:!1,staleTime:1e3*20,onError:B=>y({type:"warning",message:B.message})},{users:p,isError:c,isLoading:C}=(0,fe.R)({},{...m,enabled:v,staleTime:2*(1e3*60)}),{data:K,isLoading:H,isError:ee}=(0,z.useQuery)(["auditLogs",g],async({queryKey:B})=>{const De=B[1],{data:Le}=await D(`/admin/audit-logs${De}`);return Le},{...m,enabled:l});return{auditLogs:K,users:p,isLoading:C||H,hasError:ee||c}},Ee={...d.Z.settings.auditLogs,readUsers:d.Z.settings.users.read},ye=()=>{const{formatMessage:l}=(0,h.Z)(),{allowedActions:{canRead:v,canReadUsers:D}}=(0,r.ss)(Ee),[{query:g},y]=(0,r.Kx)(),{auditLogs:m,users:p,isLoading:c,hasError:C}=ve({canReadAuditLogs:v,canReadUsers:D});(0,r.go)();const K=X({formatMessage:l,users:p,canReadUsers:D}),H=l({id:"global.auditLogs",defaultMessage:"Audit Logs"}),ee=se.map(B=>({...B,metadatas:{...B.metadatas,label:l(B.metadatas.label)}}));return C?e.createElement(L.A,null,e.createElement(P.D,null,e.createElement(M.x,{paddingTop:8},e.createElement(r.Hn,null)))):e.createElement(A.o,{"aria-busy":c},e.createElement(r.SL,{name:H}),e.createElement(I.T,{title:H,subtitle:l({id:"Settings.permissions.auditLogs.listview.header.subtitle",defaultMessage:"Logs of all the activities that happened in your environment"})}),e.createElement(S.Z,{startActions:e.createElement(u.Z,{displayedFilters:K})}),e.createElement(P.D,{canRead:v},e.createElement(r.tM,{contentType:"Audit logs",headers:ee,rows:m?.results||[],withBulkActions:!0,isLoading:c},e.createElement(ne,{headers:ee,rows:m?.results||[],onOpenModal:B=>y({id:B})})),e.createElement(re,{pagination:m?.pagination})),g?.id&&e.createElement(i,{handleClose:()=>y({id:null},"remove"),logId:g.id}))},he=()=>e.createElement(r.O4,{permissions:d.Z.settings.auditLogs.main},e.createElement(ye,null))},2407:(Z,E,t)=>{t.d(E,{$:()=>I,O:()=>S});var e=t(85893),r=t(16405),d=t(1565),h=t(63237),L=t(11047),P=t(41580),M=t(75515);const A=(0,d.ZP)(L.k)`
  svg {
    height: ${10/16}rem;
    width: ${10/16}rem;
    path {
      fill: ${({theme:f})=>f.colors.neutral500};
    }
  }
  :last-of-type ${P.x} {
    display: none;
  }
  :last-of-type ${M.Z} {
    color: ${({theme:f})=>f.colors.neutral800};
    font-weight: ${({theme:f})=>f.fontWeights.bold};
  }
`,I=({children:f})=>(0,e.jsxs)(A,{inline:!0,as:"li",children:[(0,e.jsx)(M.Z,{variant:"pi",textColor:"neutral600",children:f}),(0,e.jsx)(P.x,{"aria-hidden":!0,paddingLeft:3,paddingRight:3,children:(0,e.jsx)(r.Z,{})})]});I.displayName="Crumb";const S=({children:f,label:o,...F})=>(0,e.jsxs)(L.k,{...F,children:[(0,e.jsx)(h.T,{children:o}),(0,e.jsx)("ol",{"aria-hidden":!0,children:f})]});S.displayName="Breadcrumbs"},90608:(Z,E,t)=>{t.d(E,{O:()=>r});var e=t(29178);const r=e.Wx},36989:(Z,E,t)=>{t.d(E,{Z:()=>d});var e=t(85893),r=t(11047);const d=({startActions:h,endActions:L})=>!h&&!L?null:(0,e.jsxs)(r.k,{justifyContent:"space-between",alignItems:"flex-start",paddingBottom:4,paddingLeft:10,paddingRight:10,children:[(0,e.jsx)(r.k,{gap:2,wrap:"wrap",children:h}),(0,e.jsx)(r.k,{gap:2,shrink:0,wrap:"wrap",children:L})]})}}]);
